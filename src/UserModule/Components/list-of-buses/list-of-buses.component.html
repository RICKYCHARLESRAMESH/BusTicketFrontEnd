<div class="background">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand text-white" href="#"><i class="fas fa-bus"></i> Bus Booking</a>
    <button
      class="btn logout-btn ms-auto"
      onclick="window.location.href='/'"
    >
      Logout
    </button>
  </div>
</nav>

<!-- Main Container -->
<div class="container">
  <h1 class="text-center mb-4"><i class="fas fa-bus"></i>List of Buses</h1>

  <!-- Search Form -->
  <div class="search-form">
    <form (ngSubmit)="searchTrips()">
      <div class="form-group mb-3">
        <label for="fromCity"><i class="fas fa-bus"></i>From City</label>
        <select
          id="fromCity"
          [(ngModel)]="fromCity"
          name="fromCity"
          class="form-control"
          required
        >
          <option value="" disabled selected>Select departure city</option>
          <option *ngFor="let city of ['Bangalore', 'Mumbai', 'Delhi', 'Hyderabad', 'Kolkata', 'Chennai', 'Jaipur', 'Lucknow', 'Patna', 'Ahmedabad', 'Pune']" [value]="city">{{ city }}</option>
        </select>
      </div>

      <div class="form-group mb-3">
        <label for="toCity"><i class="fas fa-bus"></i>To City</label>
        <select
          id="toCity"
          [(ngModel)]="toCity"
          name="toCity"
          class="form-control"
          required
        >
          <option value="" disabled selected>Select destination city</option>
          <option *ngFor="let city of ['Chennai', 'Pune', 'Agra', 'Vijayawada', 'Durgapur', 'Madurai', 'Udaipur', 'Kanpur', 'Gaya', 'Surat', 'Goa', 'Mysore', 'Jaipur', 'Nagpur', 'Coimbatore', 'Siliguri', 'Bangalore', 'Varanasi', 'Ranchi', 'Rajkot']" [value]="city">{{ city }}</option>
        </select>
      </div>

      <div class="form-group mb-3">
        <label for="tripDate"><i class="fas fa-calendar-alt"></i>
          Trip Date and Time</label>
        <input
          type="datetime-local"
          id="tripDate"
          [(ngModel)]="tripDate"
          name="tripDate"
          class="form-control"
          required
        />
      </div>

      <button type="submit" class="btn btn-primary w-100">Search Trips</button>
    </form>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="alert mt-3">
      {{ errorMessage }}
    </div>
  </div>

  <!-- List of Trips -->
  <div *ngIf="trips.length > 0" class="trip-list mt-5">
    <h2 class="text-center mb-4"><i class="fas fa-list"></i>
      Available Trips</h2>
    <div class="row">
      <div class="col-md-4" *ngFor="let trip of trips">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Route: {{ trip.route.fromCity }} → {{ trip.route.toCity }}</h5>
            <p class="card-text">
              <strong><i class="fas fa-calendar-alt" style="color: #5c4ed8;"></i>
                Trip Date:</strong> {{ trip.tripDate }}<br />
              <strong><i class="fas fa-clock" style="color: #5c4ed8;"></i>
                Departure Time:</strong> {{ trip.departureTime }}<br />
              <strong><i class="fas fa-clock" style="color: #5c4ed8;"></i>
                Arrival Time:</strong> {{ trip.arrivalTime }}<br />
              <strong><i class="fas fa-chair" style="color:#5c4ed8;"></i>
                Available Seats:</strong> {{ trip.availableSeats }}<br />
              <strong><i class="fas fa-money-bill-wave" style="color: #5c4ed8;"></i>
                Fare:</strong> ₹{{ trip.fare }}
            </p>
            <button class="btn btn-primary w-100" (click)="navigateToBookingPage(trip)">Book</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Details Form -->
  <div *ngIf="selectedTrip" class="container mt-5">
    <h2 class="text-center mb-4">User Details</h2>
    <form>
      <!-- Name Field -->
      <div class="form-group mb-3">
        <label for="name">Name</label>
        <input
          type="text"
          id="name"
          class="form-control"
          placeholder="Enter your name"
          required
        />
      </div>

      <!-- Gender Field -->
      <div class="form-group mb-3">
        <label for="gender">Gender</label>
        <select id="gender" class="form-control" required>
          <option value="" disabled selected>Select your gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other</option>
        </select>
      </div>

      <!-- Email Field -->
      <div class="form-group mb-3">
        <label for="email">Email</label>
        <input
          type="email"
          id="email"
          class="form-control"
          placeholder="Enter your email"
          required
        />
      </div>

      <!-- Phone Number Field -->
      <div class="form-group mb-3">
        <label for="phoneNumber">Phone Number</label>
        <input
          type="tel"
          id="phoneNumber"
          class="form-control"
          placeholder="Enter your phone number"
          required
        />
      </div>

      <!-- Proceed to Pay Button -->
      <button type="button" class="btn btn-primary w-100 mt-3" (click)="addPayment()">
        Proceed to Pay
      </button>
    </form>
  </div>

  <!-- No Trips Found -->
  <div *ngIf="trips.length === 0 && !errorMessage" class="alert mt-5">
    No trips found. Please try a different search.
  </div>
</div>
</div>