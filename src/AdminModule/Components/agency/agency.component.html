<!-- Navbar -->
<div class="navbar">
    <div class="logo">
        Admin Dashboard
    </div>
    <div class="nav-links">
        <ul>
            <li><a href="agency">Agencies</a></li>
            <li><a href="bus">Buses</a></li>
            <li><a href="admin-customer">Customers</a></li>
            <li><a href="drivers">Drivers</a></li>
            <li><a href="payments">Payments</a></li>
            <li><a href="reviews">Reviews</a></li>
            <li><a href="routes">Routes</a></li>
            <li><a href="trips">Trips</a></li>
        </ul>
        <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
</div>

<!-- Content Area -->
<div class="content-container">
    <h1>Manage Agencies</h1>

    <!-- Search Dropdown and Input Fields -->
    <div class="search-container">
        <label for="searchType">Search By:</label>
        <select id="searchType" [(ngModel)]="searchType">
            <option value="id">ID</option>
            <option value="name">Name</option>
        </select>

        <input *ngIf="searchType === 'name'" type="text" placeholder="Enter Agency Name" [(ngModel)]="searchAgencyName"/>
        <input *ngIf="searchType === 'id'" type="number" placeholder="Enter Agency ID" [(ngModel)]="searchAgencyId"/>

        <button class="search-btn" (click)="searchAgency()">Search</button>

        <div *ngIf="searchAgencyName && searchAgencyName.length === 0" class="error">
            Please enter a valid Agency Name.
        </div>
        <div *ngIf="searchAgencyId && searchAgencyId <= 0" class="error">
            Please enter a valid Agency ID.
        </div>
    </div>

    <!-- Add Agency Form -->
    <button class="add-agency-btn" (click)="isCreate()">Add Agency</button>

    <!-- Agency Table -->
    <table class="agency-table">
        <thead>
            <tr>
                <th>Agency ID</th>
                <th>Name</th>
                <th>Contact Person Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Actions</th> 
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let adminagency of agency">
                <td>{{ adminagency.agencyId }}</td>
                <td>{{ adminagency.name }}</td>
                <td>{{ adminagency.contactPersonName }}</td>
                <td>{{ adminagency.email }}</td>
                <td>{{ adminagency.phone }}</td>
                <td>
                    <button class="btn btn-success" (click)="editAgencyDetails(adminagency)">Edit</button>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Edit Agency Form -->
    <div *ngIf="showEditAgencyForm">
        <h2>Edit Agency</h2>
        <form (ngSubmit)="updateAgency(editAgency.agencyId, editAgency)">
            <div>
                <label for="name">Name:</label>
                <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    [(ngModel)]="editAgency.name" 
                    required 
                />
            </div>

            <div>
                <label for="contactPersonName">Contact Person Name:</label>
                <input 
                    type="text" 
                    id="contactPersonName" 
                    name="contactPersonName" 
                    [(ngModel)]="editAgency.contactPersonName" 
                    required 
                />
            </div>

            <div>
                <label for="email">Email:</label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    [(ngModel)]="editAgency.email" 
                    required 
                />
            </div>

            <div>
                <label for="phone">Phone:</label>
                <input 
                    type="text" 
                    id="phone" 
                    name="phone" 
                    [(ngModel)]="editAgency.phone" 
                    required 
                />
            </div>

            <button type="submit" class="btn btn-success">Update Agency</button>
            <button type="button" class="btn btn-secondary" (click)="showEditAgencyForm = false">Cancel</button>
        </form>
    </div>
</div>
